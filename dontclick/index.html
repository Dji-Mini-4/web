<!DOCTYPE html>
<html>
    <head>
        <style>
            body {
                background-color: black;
                color:white;
                transition: background-color 0.3s ease, color 0.3s ease;
                text-align: center;
                font-family:"consolas"
            }
            #dark-mode {
                position:absolute;
                top:6px;
                right:10px;
            }
            #timer {
                min-height: 1.5em;
            }
            #dark-mode-box {
                position: absolute;
                top: 7px;
                right: 10px;
                background: #222;
                border: 1px solid #888;
                border-radius: 6px;
                padding: 4px 24px;      /* Increased horizontal padding */
                display: flex;
                align-items: center;
                gap: 8px;
                z-index: 10;
                /* Optionally, set a min-width if you want a guaranteed width */
                min-width: 100px;
                font-size: 1.1rem
            }
            #dark-mode-box label {
                font-size: 1.1rem;
                margin-right: 8px;
                cursor: pointer;
                line-height: 1.2;
            }

            #dark-mode-box input[type="checkbox"] {
                width: 1.2em;
                height: 1.2em;
                accent-color: #3a6;
                vertical-align: middle;
                cursor: pointer;
                margin: 0;
            }
        </style>
        <title>Don't Click Me</title>
    </head>
    <body>
        <p>Don't try to click the button!</p>
        <p id="teleportation"></p>
        <p id="timer"><br></p>
        <div id="dark-mode-box">
            <label for="dark-mode">Dark Mode</label>
            <input id="dark-mode" type="checkbox" checked onchange="dark_mode()">
        </div>
        <hr>
        <button onmouseenter="block()" onmouseleave="clearTimerOnMouseLeave()" onclick="after_click()">Don't Click Me</button>

        <script>
            const body = document.querySelector('body');
            let btn_clicked = false;
            let timeout = null;
            let timerInterval = null;
            let just_clicked = false;
            let start = null;
            let lastElapsed = null;

            function ask_timeout() {
                while (true) {
                    let temp_timeout = prompt("Enter delay in milliseconds before the alert fires: (100 ðŸƒ to 1000 ðŸ¢)\nOr press Cancel to close the window.");
                    if (temp_timeout === null) {
                        let close_decision = confirm('You clicked Cancel. Close the window?');
                        if (close_decision) {
                            window.close();
                            return;
                        } else {
                            continue;
                        }
                    }
                    let input_int = parseInt(temp_timeout);

                    if (!isNaN(input_int) && input_int >= 100 && input_int <= 1000) {
                        timeout = input_int;
                        break;
                    } else if (!isNaN(input_int)) {
                        alert("Hey! Your number isn't from 100ms to 1000ms!");
                    } else {
                        alert("Hey! That's not even a number!");
                    }
                }
                document.getElementById('teleportation').innerHTML = `P.S. You have <strong>${timeout}ms</strong> before the alert fires.`
            }
            window.onload = ask_timeout;

            function block() {
                if (!timeout) return;

                start = performance.now(); // <-- Store start time
                const display = document.getElementById("timer");

                stopTimer();

                timerInterval = setInterval(() => {
                    let now = performance.now();
                    let elapsed = Math.floor(now - start);
                    lastElapsed = elapsed;

                    display.textContent = `${elapsed}ms / ${timeout}ms`;
                    const alertMsgs = [
                        "Told Ya!",
                        "Too Slow!",
                        "Ha Ha!",
                        "Gotcha!",
                        "CAUGHT YOU TRYING TO PRESS THAT BUTTON",
                        "Nice reflexes... still not enough.",
                        "You missed. Again.",
                        "This button is faster than you.",
                        "Try harder, human.",
                        "You clicked nothing. Congrats.",
                        "The button dodged you.",
                        "You blinked, didnâ€™t you?",
                        "Almost... but nope.",
                        "This button has trust issues.",
                        "You activated disappointment.",
                        "Your click has been denied.",
                        "You pressed air.",
                        "The button laughed at you.",
                        "Youâ€™ve been juked.",
                        "This is a trap. You fell for it.",
                        "You clicked. The button vanished.",
                        "You vs. Button: 0â€“1",
                        "Better luck next click.",
                        "You summoned sarcasm.",
                        "This button is a ninja.",
                        "You touched the void.",
                        "Denied by design.",
                        "The button says: 'Not today.'",
                        "You clicked. Reality disagreed.",
                        "Youâ€™ve been click-blocked.",
                        "You clicked... and nothing happened. Just like your dreams."
                    ];

                    alertMsg = alertMsgs[Math.round(Math.random() * 30) - 1]
                    if (elapsed >= timeout) {
                        stopTimer();
                        if (!btn_clicked) alert(alertMsg);
                    }
                }, 10);
            }

            function stopTimer() {
                clearInterval(timerInterval);
                timerInterval = null;
                if (just_clicked) {
                    just_clicked = false;
                    return;
                }
            }

            function clearTimerOnMouseLeave() {
                if (!btn_clicked) {
                    stopTimer();
                    document.getElementById("timer").textContent = ""
                }
            }

            function after_click() {
                const dramaticMsgs = [
                    "<b><i>THE BUTTON HAS BEEN VIOLATED!</i></b>",
                    "<b><i>YOU JUST UNLEASHED THE UNTHINKABLE!</i></b>",
                    "<b><i>THE SACRED CLICK HAS BEEN MADE... CONSEQUENCES WILL FOLLOW.</i></b>",
                    "<b><i>REALITY IS COLLAPSING. NICE JOB.</i></b>",
                    "<b><i>THE LEGENDS WARNED US ABOUT THIS DAY.</i></b>",
                    "<b><i>YOU'VE AWAKENED THE BUTTON'S WRATH!</i></b>",
                    "<b><i>THE SYSTEM IS SHOOK. THE BUTTON IS BETRAYED.</i></b>",
                    "<b><i>YOU CLICKED. THE COSMOS BLINKED.</i></b>",
                    "<b><i>THE BUTTON CRIED OUT IN AGONY!</i></b>",
                    "<b><i>YOU HAVE SUMMONED THE FINAL PROTOCOL.</i></b>",
                    "<b><i>THE CLICK ECHOES THROUGH TIME.</i></b>",
                    "<b><i>THE BUTTON HAS BEEN DEFILED. REPENT.</i></b>",
                    "<b><i>THE UNIVERSE JUST FILED A COMPLAINT.</i></b>",
                    "<b><i>YOU BROKE THE UNWRITTEN RULE.</i></b>",
                    "<b><i>THE BUTTON IS DISAPPOINTED IN YOU.</i></b>",
                    "<b><i>THE CLICK... IT WASNâ€™T SUPPOSED TO HAPPEN.</i></b>",
                    "<b><i>YOUâ€™VE TRIGGERED THE APOCALYPSE SEQUENCE.</i></b>",
                    "<b><i>THE BUTTON HAS ENTERED EMERGENCY MODE.</i></b>",
                    "<b><i>YOUâ€™VE BEEN LOGGED... FOR ETERNAL JUDGMENT.</i></b>",
                    "<b><i>THE CLICK HAS BEEN RECORDED IN THE BOOK OF SHAME.</i></b>"
                ];

                // ðŸ§¹ Clear previous dramatic messages only (not buttons)
                document.querySelectorAll('.dynamic-msg').forEach(el => el.remove());

                // clear reset buttons
                document.querySelectorAll('.reset-btn').forEach(el => el.remove());

                // âœ… Reset state
                btn_clicked = true;
                just_clicked = true;

                stopTimer(); // Stop timer immediately

                // ðŸ§ª Safety check
                if (!timeout || lastElapsed === null) {
                    console.warn("Missing timeout or elapsed time.");
                    return;
                }

                // ðŸŽ­ Create dramatic message
                const msg = document.createElement('p');
                msg.className = "dynamic-msg";
                const dramaticMsg = dramaticMsgs[Math.floor(Math.random() * dramaticMsgs.length)];
                msg.innerHTML = `<b><i>WHAT????????? YOU ACTUALLY CLICKED ON THAT BUTTON?</i></b><br><i>${dramaticMsg}</i>`;
                body.appendChild(msg);

                // ðŸ•’ Show score
                const score = document.createElement('p');
                score.className = "dynamic-msg";
                score.innerHTML = `<span style="color:yellow">Your score: ${lastElapsed}ms / ${timeout}ms</span>`;
                body.appendChild(score);

                // ðŸ” Add reset button (with a different class so it doesn't get wiped)
                const resetBtn = document.createElement('button');
                resetBtn.textContent = "Reset";
                resetBtn.className = "reset-btn";
                resetBtn.onclick = reset;
                body.appendChild(resetBtn);

                setTimeout(() => {
                    btn_clicked = false;
                }, 1000); // 1 second cooldown
            }

            function dark_mode() {
                body.style.backgroundColor = body.style.backgroundColor === "white" ? "black" : "white";
                body.style.color = body.style.backgroundColor === "black" ? "white" : "black";
            }

            function reset() {
                btn_clicked = false;
                document.querySelectorAll('.dynamic-msg').forEach(el => el.remove());
                document.querySelectorAll('button:not(:first-of-type)').forEach(el => el.remove());
            }
        </script>
    </body>
</html>
